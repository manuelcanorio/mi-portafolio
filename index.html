<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Portfolio</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            margin-bottom: 40px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(45deg, #fff, #a8edea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .btn-primary:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .btn-logout {
            background: rgba(255,255,255,0.15);
            color: white;
            backdrop-filter: blur(10px);
        }

        .btn-logout:hover {
            background: rgba(255,100,100,0.4);
        }

        /* Home Section */
        .home-section {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 50px;
            align-items: center;
            margin: 60px 0;
            animation: fadeIn 0.8s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .profile-image {
            width: 300px;
            height: 300px;
            border-radius: 30px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 100px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 27px;
        }

        .profile-image::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0%, 100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .profile-info h1 {
            font-size: 48px;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #fff, #a8edea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .profile-info p {
            font-size: 18px;
            line-height: 1.8;
            color: rgba(255,255,255,0.9);
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        /* Login Section */
        .login-section {
            max-width: 450px;
            margin: 80px auto;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            padding: 50px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.2);
            animation: fadeIn 0.8s ease;
        }

        .login-section h2 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 36px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .form-group input:focus {
            outline: none;
            border-color: rgba(255,255,255,0.5);
            background: rgba(255,255,255,0.15);
        }

        .btn-submit {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .error-message {
            background: rgba(255,100,100,0.2);
            color: #fff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,100,100,0.3);
            display: none;
        }

        .success-message {
            background: rgba(100,255,100,0.2);
            color: #fff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid rgba(100,255,100,0.3);
            display: none;
        }

        /* Weeks Section */
        .weeks-section {
            animation: fadeIn 0.8s ease;
        }

        .weeks-header {
            margin-bottom: 40px;
        }

        .weeks-header h2 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .weeks-header p {
            color: rgba(255,255,255,0.8);
            font-size: 16px;
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .week-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            min-height: 200px;
        }

        .week-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            background: rgba(255,255,255,0.15);
        }

        .week-card h3 {
            margin-bottom: 20px;
            font-size: 24px;
            color: #a8edea;
        }

        .upload-area {
            border: 2px dashed rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .upload-area:hover {
            border-color: rgba(255,255,255,0.5);
            background: rgba(255,255,255,0.05);
        }

        .upload-area.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .upload-area input[type="file"] {
            display: none;
        }

        .upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .upload-text {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
        }

        .file-list {
            margin-top: 15px;
        }

        .file-item {
            background: rgba(255,255,255,0.1);
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .file-name {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            overflow: hidden;
        }

        .file-name span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-icon {
            font-size: 18px;
        }

        .file-user {
            font-size: 11px;
            color: rgba(255,255,255,0.6);
            margin-top: 3px;
        }

        .btn-delete {
            background: rgba(255,100,100,0.3);
            border: none;
            color: white;
            padding: 5px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .btn-delete:hover {
            background: rgba(255,100,100,0.5);
        }

        .btn-delete.hidden {
            display: none;
        }

        .btn-download {
            background: rgba(100,200,255,0.3);
            border: none;
            color: white;
            padding: 5px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            margin-right: 5px;
        }

        .btn-download:hover {
            background: rgba(100,200,255,0.5);
        }

        .file-actions {
            display: flex;
            gap: 5px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: rgba(255,255,255,0.7);
        }

        .hidden {
            display: none !important;
        }

        input:-webkit-autofill,
        input:-webkit-autofill:hover, 
        input:-webkit-autofill:focus {
            -webkit-text-fill-color: white;
            -webkit-box-shadow: 0 0 0px 1000px rgba(255,255,255,0.1) inset;
            transition: background-color 5000s ease-in-out 0s;
        }

        @media (max-width: 768px) {
            .home-section {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .profile-image {
                margin: 0 auto;
            }

            .week-grid {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">Mi Portfolio</div>
            <div class="nav-buttons">
                <button class="btn btn-primary" id="homeBtn" onclick="showHome()">Inicio</button>
                <button class="btn btn-primary" id="weeksBtn" onclick="showWeeks()">Semanas</button>
                <button class="btn btn-primary" id="loginBtn" onclick="showLogin()">Iniciar Sesión</button>
                <button class="btn btn-logout hidden" id="logoutBtn" onclick="logout()">Cerrar Sesión</button>
            </div>
        </header>

        <!-- Home Section -->
        <div class="home-section" id="homeSection">
            <div class="profile-image">
                👤
            </div>
            <div class="profile-info">
                <h1>Tu Nombre</h1>
                <p>
                    Hola! Soy un estudiante apasionado por el aprendizaje continuo. 
                    En este espacio personal comparto mi progreso semanal, proyectos y 
                    tareas que voy completando a lo largo del semestre. 
                    Mi objetivo es documentar mi crecimiento y mantener un registro 
                    organizado de todas mis actividades académicas durante las 16 semanas del curso.
                </p>
            </div>
        </div>

        <!-- Login Section -->
        <div class="login-section hidden" id="loginSection">
            <h2>Iniciar Sesión</h2>
            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage"></div>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Correo Electrónico</label>
                    <input type="email" id="email" placeholder="tu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" id="password" placeholder="••••••••" required>
                </div>
                <button type="submit" class="btn-submit">Entrar</button>
            </form>
        </div>

        <!-- Weeks Section -->
        <div class="weeks-section hidden" id="weeksSection">
            <div class="weeks-header">
                <h2>Semanas del Curso</h2>
                <p>Sube tus archivos y tareas para cada semana del semestre</p>
            </div>

            <div class="week-grid" id="weekGrid">
                <div class="loading">Cargando semanas...</div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURACIÓN DE SUPABASE
        // ============================================
        // IMPORTANTE: Reemplaza con tus credenciales reales
        const SUPABASE_URL = 'https://anngniwredatpzexycmr.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFubmduaXdyZWRhdHB6ZXh5Y21yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3MDY0MTIsImV4cCI6MjA3NjI4MjQxMn0.LjYdLFLwNcyFP1KimhXFzXDfq1vJjKblg56hluLechk';
        
        let supabase;
        let currentUser = null;

        // ============================================
        // INICIALIZACIÓN
        // ============================================
        async function init() {
            try {
                // Inicializar Supabase
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                
                // Verificar sesión activa
                const { data: { session } } = await supabase.auth.getSession();
                
                if (session) {
                    currentUser = session.user;
                    showAuthenticatedUI();
                }
                
                // Crear las tarjetas de semanas
                await createWeekCards();
                
            } catch (error) {
                console.error('Error al inicializar:', error);
                showError('Error al conectar con Supabase. Verifica tus credenciales.');
            }
        }

        // ============================================
        // NAVEGACIÓN
        // ============================================
        function showHome() {
            document.getElementById('homeSection').classList.remove('hidden');
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('weeksSection').classList.add('hidden');
        }

        function showLogin() {
            document.getElementById('homeSection').classList.add('hidden');
            document.getElementById('loginSection').classList.remove('hidden');
            document.getElementById('weeksSection').classList.add('hidden');
        }

        async function showWeeks() {
            document.getElementById('homeSection').classList.add('hidden');
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('weeksSection').classList.remove('hidden');
            await loadAllFiles();
        }

        // ============================================
        // AUTENTICACIÓN
        // ============================================
        async function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) throw error;

                currentUser = data.user;
                showAuthenticatedUI();
                showSuccess('Sesión iniciada correctamente');
                
                setTimeout(async () => {
                    await showWeeks();
                    await createWeekCards();
                }, 1500);
                
                document.getElementById('loginForm').reset();
            } catch (error) {
                showError('Error al iniciar sesión: ' + error.message);
            }
        }

        async function logout() {
            try {
                await supabase.auth.signOut();
                currentUser = null;
                showUnauthenticatedUI();
                await createWeekCards();
                showHome();
                showSuccess('Sesión cerrada');
            } catch (error) {
                showError('Error al cerrar sesión');
            }
        }

        function showAuthenticatedUI() {
            document.getElementById('loginBtn').classList.add('hidden');
            document.getElementById('logoutBtn').classList.remove('hidden');
        }

        function showUnauthenticatedUI() {
            document.getElementById('loginBtn').classList.remove('hidden');
            document.getElementById('logoutBtn').classList.add('hidden');
        }

        // ============================================
        // CREAR TARJETAS DE SEMANAS
        // ============================================
        async function createWeekCards() {
            const grid = document.getElementById('weekGrid');
            grid.innerHTML = '';

            for (let i = 1; i <= 16; i++) {
                const card = document.createElement('div');
                card.className = 'week-card';
                
                const uploadAreaClass = currentUser ? 'upload-area' : 'upload-area disabled';
                const uploadText = currentUser ? 'Click para subir archivos' : 'Inicia sesión para subir archivos';
                
                card.innerHTML = `
                    <h3>Semana ${i}</h3>
                    <div class="${uploadAreaClass}" onclick="${currentUser ? `document.getElementById('fileInput${i}').click()` : ''}">
                        <div class="upload-icon">📁</div>
                        <div class="upload-text">${uploadText}</div>
                        ${currentUser ? `<input type="file" id="fileInput${i}" multiple onchange="handleFileUpload(${i}, event)">` : ''}
                    </div>
                    <div class="file-list" id="fileList${i}">
                        <div class="loading" style="font-size: 12px;">Cargando archivos...</div>
                    </div>
                `;
                grid.appendChild(card);
            }

            await loadAllFiles();
        }

        // ============================================
        // SUBIR ARCHIVOS
        // ============================================
        async function handleFileUpload(weekNumber, event) {
            if (!currentUser) {
                showError('Debes iniciar sesión primero');
                return;
            }

            const files = Array.from(event.target.files);
            
            try {
                for (const file of files) {
                    // Limpiar el nombre del archivo (remover caracteres especiales)
                    const cleanFileName = file.name
                        .normalize('NFD')
                        .replace(/[\u0300-\u036f]/g, '') // Remover acentos
                        .replace(/[^a-zA-Z0-9._-]/g, '_') // Reemplazar caracteres especiales
                        .replace(/_{2,}/g, '_'); // Evitar múltiples guiones bajos seguidos
                    
                    // Crear nombre único para el archivo
                    const timestamp = Date.now();
                    const fileName = `${currentUser.id}/${weekNumber}/${timestamp}_${cleanFileName}`;

                    // Subir archivo a Supabase Storage
                    const { data: uploadData, error: uploadError } = await supabase.storage
                        .from('week-files')
                        .upload(fileName, file, {
                            cacheControl: '3600',
                            upsert: false
                        });

                    if (uploadError) throw uploadError;

                    // Guardar metadata en la tabla
                    const { error: dbError } = await supabase
                        .from('files')
                        .insert([
                            {
                                user_id: currentUser.id,
                                user_email: currentUser.email,
                                week_number: weekNumber,
                                file_name: file.name,
                                file_path: fileName,
                                file_size: file.size,
                                file_type: file.type
                            }
                        ]);

                    if (dbError) throw dbError;
                }

                showSuccess(`${files.length} archivo(s) agregado(s) a la Semana ${weekNumber}`);
                await loadAllFiles();
                
                // Limpiar el input de archivo
                event.target.value = '';
                
            } catch (error) {
                console.error('Error al subir archivo:', error);
                showError('Error al subir archivo: ' + error.message);
            }
        }

        // ============================================
        // CARGAR ARCHIVOS
        // ============================================
        async function loadAllFiles() {
            try {
                // Obtener todos los archivos de la base de datos
                const { data: files, error } = await supabase
                    .from('files')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                // Limpiar todas las listas
                for (let i = 1; i <= 16; i++) {
                    const fileList = document.getElementById(`fileList${i}`);
                    if (fileList) fileList.innerHTML = '';
                }

                // Agrupar archivos por semana y mostrarlos
                files.forEach(file => {
                    displayFile(file);
                });

            } catch (error) {
                console.error('Error al cargar archivos:', error);
                showError('Error al cargar archivos');
            }
        }

        // ============================================
        // MOSTRAR ARCHIVO
        // ============================================
        function displayFile(file) {
            const fileList = document.getElementById(`fileList${file.week_number}`);
            if (!fileList) return;

            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            
            const fileIcon = getFileIcon(file.file_name);
            const canDelete = currentUser && currentUser.id === file.user_id;
            
            // Escapar comillas en los nombres de archivo
            const escapedPath = file.file_path.replace(/'/g, "\\'");
            const escapedName = file.file_name.replace(/'/g, "\\'");
            
            // Botones de acción
            let actionButtons = '';
            if (canDelete) {
                // Usuario autenticado puede ver, descargar y eliminar sus archivos
                actionButtons = `
                    <div class="file-actions">
                        <button class="btn-download" onclick="window.viewFile('${escapedPath}', '${escapedName}')">👁️ Ver</button>
                        <button class="btn-download" onclick="window.downloadFile('${escapedPath}', '${escapedName}')">⬇️</button>
                        <button class="btn-delete" onclick="window.deleteFile('${file.id}', ${file.week_number})">✕</button>
                    </div>
                `;
            } else if (currentUser) {
                // Usuario autenticado puede ver y descargar archivos de otros
                actionButtons = `
                    <div class="file-actions">
                        <button class="btn-download" onclick="window.viewFile('${escapedPath}', '${escapedName}')">👁️ Ver</button>
                        <button class="btn-download" onclick="window.downloadFile('${escapedPath}', '${escapedName}')">⬇️</button>
                    </div>
                `;
            } else {
                // Usuario NO autenticado solo puede ver y descargar
                actionButtons = `
                    <div class="file-actions">
                        <button class="btn-download" onclick="window.viewFile('${escapedPath}', '${escapedName}')">👁️ Ver</button>
                        <button class="btn-download" onclick="window.downloadFile('${escapedPath}', '${escapedName}')">⬇️</button>
                    </div>
                `;
            }
            
            fileItem.innerHTML = `
                <div class="file-name">
                    <span class="file-icon">${fileIcon}</span>
                    <div>
                        <span title="${file.file_name}">${file.file_name}</span>
                        <div class="file-user">Subido por: ${file.user_email}</div>
                    </div>
                </div>
                ${actionButtons}
            `;
            
            fileList.appendChild(fileItem);
        }

        // ============================================
        // VER ARCHIVO
        // ============================================
        window.viewFile = async function(filePath, fileName) {
            try {
                // Obtener URL pública del archivo
                const { data, error } = await supabase.storage
                    .from('week-files')
                    .createSignedUrl(filePath, 3600); // URL válida por 1 hora

                if (error) throw error;

                // Abrir en nueva pestaña
                window.open(data.signedUrl, '_blank');

            } catch (error) {
                console.error('Error al ver archivo:', error);
                showError('Error al ver archivo: ' + error.message);
            }
        }

        // ============================================
        // DESCARGAR ARCHIVO
        // ============================================
        window.downloadFile = async function(filePath, fileName) {
            try {
                // Descargar archivo
                const { data, error } = await supabase.storage
                    .from('week-files')
                    .download(filePath);

                if (error) throw error;

                // Crear URL del blob y descargar
                const url = URL.createObjectURL(data);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showSuccess('Archivo descargado correctamente');

            } catch (error) {
                console.error('Error al descargar archivo:', error);
                showError('Error al descargar archivo: ' + error.message);
            }
        }

        // ============================================
        // ELIMINAR ARCHIVO
        // ============================================
        window.deleteFile = async function(fileId, weekNumber) {
            if (!currentUser) {
                showError('Debes iniciar sesión primero');
                return;
            }

            try {
                // Obtener información del archivo
                const { data: file, error: fetchError } = await supabase
                    .from('files')
                    .select('*')
                    .eq('id', fileId)
                    .single();

                if (fetchError) throw fetchError;

                // Verificar que el usuario sea el dueño
                if (file.user_id !== currentUser.id) {
                    showError('No puedes eliminar archivos de otros usuarios');
                    return;
                }

                // Eliminar de Storage
                const { error: storageError } = await supabase.storage
                    .from('week-files')
                    .remove([file.file_path]);

                if (storageError) throw storageError;

                // Eliminar de la base de datos
                const { error: dbError } = await supabase
                    .from('files')
                    .delete()
                    .eq('id', fileId);

                if (dbError) throw dbError;

                showSuccess('Archivo eliminado correctamente');
                await loadAllFiles();

            } catch (error) {
                console.error('Error al eliminar archivo:', error);
                showError('Error al eliminar archivo: ' + error.message);
            }
        }

        // ============================================
        // UTILIDADES
        // ============================================
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                pdf: '📄',
                doc: '📝',
                docx: '📝',
                txt: '📝',
                xls: '📊',
                xlsx: '📊',
                ppt: '📊',
                pptx: '📊',
                jpg: '🖼️',
                jpeg: '🖼️',
                png: '🖼️',
                gif: '🖼️',
                zip: '🗜️',
                rar: '🗜️',
                mp4: '🎥',
                mp3: '🎵',
                default: '📎'
            };
            return icons[ext] || icons.default;
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }

        // ============================================
        // INICIAR APLICACIÓN
        // ============================================
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
